

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelling of chip probabilities &#8212; Urban Grammar AI | WP3 - Signature AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Explore model performances" href="explore_model_performance.html" />
    <link rel="prev" title="Predict signature types from a numpy array of chips" href="predict_from_numpy.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Urban Grammar AI | WP3 - Signature AI</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Project
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz">
   Project homepage
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz/data_processing">
   WP1 - Data processing
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="http://urbangrammarai.xyz/spatial_signatures">
   WP2 - Spatial Signatures
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Create chips
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_a.html">
   Chip making
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_b.html">
   Chip making - Pt. B
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_subset.html">
   Chip making for a subset of GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_subset.html#spill-chips-to-disk-for-out-of-core-computation">
   Spill chips to disk for out-of-core computation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_gb.html">
   Create chips for the majority of GB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/chip_making_temporal.html">
   Create chips from a temporal set of Sentinel 2 snapshots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../create_chips/check_temporal_tiles.html">
   Plot temporal tiles
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  AI experiments
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="transfer_learning_pipe.html">
   Model testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transfer_learning_evaluation.html">
   Evaluation of models trained on NW
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tl_from_disk.html">
   AI pipeline from disk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chip_size_eval.html">
   Evaluation of the effect of chip size and origin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="predict_from_numpy.html">
   Predict signature types from a numpy array of chips
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Modelling of chip probabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="explore_model_performance.html">
   Explore model performances
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ai_experiments/sp_model_chip_probabilities.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/urbangrammarai/signature_ai"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/urbangrammarai/signature_ai/master?urlpath=tree/ai_experiments/sp_model_chip_probabilities.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probabilities">
     Probabilities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#labels">
     Labels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-db-all">
     Build
     <code class="docutils literal notranslate">
      <span class="pre">
       db_all
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-validation-split">
     Train/Validation split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-lag">
     Spatial lag
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#overview">
       Overview
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#split-lag">
       Split lag
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#block-split-lag">
       Block Split lag
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interaction-variables">
     Interaction variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-db">
     Build
     <code class="docutils literal notranslate">
      <span class="pre">
       db
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-train-val-indices">
     Extract train/val indices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#class-im-balance">
     Class (im)balance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#single-class-models">
   Single class models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#max-probability">
     Max. Probability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logit-ensemble">
     Logit ensemble
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#baseline">
       Baseline
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#baseline-wx">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#baseline-wx-x-times-wx">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
       +
       <span class="math notranslate nohighlight">
        \(X\times WX\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multinomial-logit">
     Multinomial Logit
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Baseline
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-forest">
     Random Forest
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Baseline
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram-based-gradient-boosting">
     Histogram-Based Gradient Boosting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Baseline
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-tree-boosting">
     Gradient Tree Boosting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Baseline
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Baseline +
       <span class="math notranslate nohighlight">
        \(WX\)
       </span>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="modelling-of-chip-probabilities">
<h1>Modelling of chip probabilities<a class="headerlink" href="#modelling-of-chip-probabilities" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span><span class="o">,</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RandomForestClassifier</span><span class="p">,</span> 
    <span class="n">GradientBoostingClassifier</span><span class="p">,</span> 
    <span class="n">HistGradientBoostingClassifier</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">tools_chip_prob_modelling</span> <span class="k">as</span> <span class="nn">tools</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">ERROR 1: PROJ: proj_create_from_database: Open of /opt/conda/share/proj failed
</pre>
</div>
</div>
</div>
<div class="section" id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="probabilities">
<h3>Probabilities<a class="headerlink" href="#probabilities" title="Permalink to this headline">¶</a></h3>
<p>Probabilities for each category by chip, as produced by the neural network:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;/home/jovyan/data/spatial_signatures/chip_probs/32_nw_pred.parquet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also keep the names of all classes separate and semantically sorted as it’ll come in handy afterwards:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;urbanity&#39;,
 &#39;dense_urban_neighbourhoods&#39;,
 &#39;dense_residential_neighbourhoods&#39;,
 &#39;connected_residential_neighbourhoods&#39;,
 &#39;gridded_residential_quarters&#39;,
 &#39;accessible_suburbia&#39;,
 &#39;disconnected_suburbia&#39;,
 &#39;open_sprawl&#39;,
 &#39;warehouse_park_land&#39;,
 &#39;urban_buffer&#39;,
 &#39;countryside_agriculture&#39;,
 &#39;wild_countryside&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="labels">
<h3>Labels<a class="headerlink" href="#labels" title="Permalink to this headline">¶</a></h3>
<p>Proportions of observed classes per chip. They are aligned with <code class="docutils literal notranslate"><span class="pre">probs</span></code> so we can remove the <code class="docutils literal notranslate"><span class="pre">geometry</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s1">&#39;/home/jovyan/data/spatial_signatures/chip_probs/chip_proportions.pq&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>These are encoded in following a grouping described in the JSON model file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd2nm</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">parse_nn_json</span><span class="p">(</span>
    <span class="s1">&#39;/home/jovyan/data/spatial_signatures/chip_probs/efficientnet_pooling_256_12.json&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We replace the code in <code class="docutils literal notranslate"><span class="pre">labels</span></code> by the name and aggregate by column names so we have the proportions in each chip by name rather than code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">relabels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cd2nm</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">relabels</span></code> contains a few rows with a total probability sum of 0: these are chips that fall within the water. We remove them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">relabels_nw</span> <span class="o">=</span> <span class="n">relabels</span><span class="p">[</span><span class="n">relabels</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span> <span class="c1"># 0.5 to avoid rounding errors</span>
</pre></div>
</div>
</div>
</div>
<p>To begin with, we focus on single class chips. We identify which are single class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_class</span> <span class="o">=</span> <span class="n">relabels_nw</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">relabels_nw</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
<span class="n">single_class</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">single_class</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Pct single class</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>66.80763900211969
</pre></div>
</div>
</div>
</div>
<p>And then pull the class for each of them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">relabels_nw</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="build-db-all">
<h3>Build <code class="docutils literal notranslate"><span class="pre">db_all</span></code><a class="headerlink" href="#build-db-all" title="Permalink to this headline">¶</a></h3>
<p>Single table with probabilities, labels and single-class flag:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db_all</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="s1">&#39;single_class&#39;</span><span class="p">:</span> <span class="n">single_class</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">db_all</span><span class="p">[</span><span class="s1">&#39;single_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">db_all</span><span class="p">[</span><span class="s1">&#39;single_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note not all chips have a <code class="docutils literal notranslate"><span class="pre">label</span></code> and <code class="docutils literal notranslate"><span class="pre">single_class</span></code> value. To make sure they are consistent, we replace the <code class="docutils literal notranslate"><span class="pre">N/A</span></code> in <code class="docutils literal notranslate"><span class="pre">single_class</span></code> by a <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
<div class="section" id="train-validation-split">
<h3>Train/Validation split<a class="headerlink" href="#train-validation-split" title="Permalink to this headline">¶</a></h3>
<p>Next, we split the sample into train and validation sets. The training split proportion is set by the global parameter <code class="docutils literal notranslate"><span class="pre">TRAIN_FRAC</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db_all</span><span class="p">[</span><span class="s1">&#39;train_all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">db_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">db_all</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">TRAIN_FRAC</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;train_all&#39;</span>
<span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="spatial-lag">
<h3>Spatial lag<a class="headerlink" href="#spatial-lag" title="Permalink to this headline">¶</a></h3>
<div class="section" id="overview">
<h4>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h4>
<p>Some models will include spatial context. Here we calculate these measures through the spatial lag of the probability for each class. Given we are in a train/validation split context, there are two ways to approach the construction of the lag:</p>
<ol class="simple">
<li><p>[<code class="docutils literal notranslate"><span class="pre">wa</span></code>] Absolute lag: we first calculate the lag for each chip, then split between train/validation. This ensures the lag is representative of the geographic context on the ground, but runs the risk of spilling information between train and validation samples. We say here “runs the risk” because the validation chips are <em>not</em> used as focal chips for training and thus the model does not “see” them as such. However, validation chips are <em>also</em> seen by the model as context, and that does make information cross between the sets. We consider this option as a way to explore the extent of this issue. One complication is that this approach also provides more information about geographic context. In the vent these models had higher performance (likely), it might not be clear which source is driving the boost: the better representation of geographic context, or the information cross-over between train and validation sets.</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">ws</span></code>] Split lag: here we start by splitting the set into train/validation and then we calculate the spatial lag separately. This is a cleaner way to assess performance, but also one that distorts geographical context so might potentially perform worse than a model that could include a better representation.</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">wbs</span></code>] Block split lag: here we use a different train/validation split that relies on blocks of 3x3 chips to not be separated. Also, we only use focal chips for model fitting and evaluation. This ensures a clean cut between train/val <em>and</em> full geographic context, at the expense of less observations in the model.</p></li>
</ol>
<p>After discussions, we have decided to start with <code class="docutils literal notranslate"><span class="pre">ws</span></code>. Upon further reflection, <code class="docutils literal notranslate"><span class="pre">wa</span></code> implies a clear case of “leakage” of information from the validation into the training sets, and thus “pollutes” the estimates of accuracy. The <code class="docutils literal notranslate"><span class="pre">wbs</span></code> remains valid but two caveats apply: a) a proper implementation of the approach results in an important loss of observations (for every 3x3 block of chips, only one of them enters the modeling), and this probably has an important effect on smaller classes such as the urbanities; b) at a theoretical level, it is still not clear it’s the preferred approach (see <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0304380021002489?via=ihub">Wadoux et al. 2021</a>; for context). On this last point, my (DA-B) sense is that it still makes sense to block in smaller chunks and split those between train and validation because you want to ensure that the effect of context is characterised adequately, and the risk of not picking up the variation desired in both training and validation sets (the main concern of Wadoux et al. 2021) is lessened by blocking at a relatively small scale and randomly sampling from those</p>
</div>
<div class="section" id="split-lag">
<h4>Split lag<a class="headerlink" href="#split-lag" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lag_all</span> <span class="o">=</span> <span class="n">db_all</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">lag_columns</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/libpysal/weights/weights.py:172: UserWarning: The weights matrix is not fully connected: 
 There are 4895 disconnected components.
 There are 1771 islands with ids: 11, 13, 14, 15, 28, 44, 46, 52, 53, 66, 71, 140, 156, 175, 185, 189, 195, 209, 219, 292, 293, 333, 342, 359, 398, 425, 432, 436, 452, 477, 480, 481, 521, 537, 561, 582, 596, 597, 599, 627, 629, 654, 656, 688, 804, 841, 860, 885, 896, 936, 975, 1001, 1010, 1074, 1140, 1149, 1181, 1182, 1183, 1185, 1186, 1197, 1198, 1218, 1227, 1228, 1229, 1230, 1272, 1273, 1284, 1294, 1296, 1300, 1346, 1357, 1386, 1408, 1413, 1489, 1502, 1503, 1509, 1518, 1519, 1521, 1541, 1564, 1595, 1603, 1612, 1707, 1710, 1711, 1754, 1868, 1870, 1874, 1884, 1894, 1921, 1942, 1943, 1953, 1955, 1956, 1957, 1965, 1969, 1981, 1985, 2032, 2036, 2067, 2105, 2120, 2121, 2125, 2126, 2133, 2166, 2187, 2206, 2217, 2220, 2226, 2228, 2280, 2325, 2337, 2352, 2372, 2386, 2435, 2449, 2457, 2473, 2480, 2492, 2515, 2533, 2560, 2561, 2562, 2570, 2584, 2587, 2596, 2607, 2710, 2711, 2733, 2742, 2756, 2765, 2781, 2817, 2819, 2820, 2828, 2851, 2864, 2868, 2874, 2885, 2887, 2890, 2891, 2892, 2893, 2894, 2918, 2924, 2926, 2942, 2957, 2962, 2980, 3022, 3025, 3026, 3054, 3057, 3117, 3140, 3142, 3143, 3146, 3174, 3203, 3238, 3284, 3308, 3309, 3315, 3340, 3341, 3342, 3356, 3374, 3384, 3389, 3432, 3529, 3536, 3550, 3551, 3557, 3582, 3595, 3616, 3644, 3645, 3680, 3689, 3696, 3724, 3752, 3771, 3777, 3783, 3788, 3830, 3831, 3832, 3859, 3915, 3916, 3988, 3998, 4011, 4036, 4041, 4042, 4067, 4068, 4069, 4080, 4097, 4098, 4123, 4135, 4196, 4203, 4204, 4218, 4220, 4224, 4230, 4231, 4232, 4246, 4251, 4257, 4258, 4282, 4287, 4292, 4387, 4393, 4398, 4417, 4446, 4475, 4498, 4504, 4516, 4548, 4574, 4579, 4604, 4616, 4622, 4623, 4647, 4648, 4656, 4661, 4667, 4680, 4699, 4718, 4765, 4778, 4807, 4820, 4850, 4868, 4877, 4878, 4879, 4888, 4921, 4948, 4957, 4958, 4971, 4983, 4984, 5005, 5030, 5031, 5039, 5042, 5083, 5089, 5091, 5135, 5139, 5154, 5168, 5173, 5184, 5192, 5226, 5279, 5288, 5305, 5306, 5310, 5337, 5383, 5403, 5424, 5451, 5495, 5500, 5549, 5553, 5585, 5589, 5632, 5679, 5692, 5693, 5695, 5717, 5760, 5866, 5872, 5962, 5982, 5989, 5991, 6004, 6005, 6018, 6047, 6053, 6055, 6064, 6141, 6206, 6210, 6211, 6240, 6251, 6262, 6264, 6292, 6328, 6331, 6332, 6350, 6360, 6391, 6394, 6441, 6442, 6448, 6452, 6458, 6469, 6484, 6508, 6511, 6525, 6537, 6561, 6568, 6585, 6600, 6640, 6683, 6684, 6686, 6687, 6702, 6711, 6723, 6742, 6757, 6774, 6812, 6816, 6826, 6848, 6863, 6873, 6896, 6934, 6969, 6970, 6971, 6989, 7014, 7049, 7050, 7051, 7087, 7093, 7105, 7166, 7167, 7173, 7212, 7216, 7235, 7240, 7265, 7274, 7275, 7304, 7350, 7351, 7359, 7363, 7378, 7386, 7387, 7453, 7466, 7468, 7476, 7487, 7504, 7538, 7564, 7568, 7569, 7597, 7616, 7617, 7638, 7641, 7642, 7644, 7648, 7649, 7650, 7651, 7665, 7666, 7673, 7690, 7693, 7704, 7708, 7760, 7774, 7775, 7781, 7801, 7802, 7811, 7812, 7813, 7814, 7831, 7854, 7858, 7920, 7965, 7966, 8006, 8012, 8013, 8024, 8025, 8031, 8038, 8078, 8079, 8097, 8113, 8128, 8133, 8140, 8188, 8193, 8215, 8216, 8246, 8249, 8250, 8252, 8253, 8258, 8290, 8303, 8314, 8337, 8338, 8362, 8368, 8410, 8476, 8477, 8489, 8490, 8509, 8516, 8523, 8533, 8538, 8543, 8563, 8637, 8672, 8679, 8722, 8723, 8739, 8744, 8798, 8811, 8840, 8878, 8896, 8917, 8927, 8928, 8978, 8988, 9024, 9047, 9052, 9083, 9085, 9099, 9196, 9211, 9219, 9220, 9226, 9270, 9296, 9297, 9299, 9325, 9342, 9399, 9406, 9412, 9413, 9437, 9475, 9480, 9486, 9522, 9536, 9538, 9544, 9546, 9561, 9562, 9566, 9567, 9648, 9656, 9663, 9666, 9677, 9686, 9688, 9690, 9761, 9773, 9781, 9788, 9879, 9894, 9931, 9939, 9942, 9943, 9955, 10004, 10037, 10043, 10084, 10089, 10113, 10157, 10162, 10163, 10189, 10192, 10229, 10255, 10289, 10296, 10320, 10333, 10380, 10441, 10444, 10445, 10446, 10448, 10455, 10483, 10494, 10495, 10496, 10505, 10527, 10528, 10538, 10543, 10561, 10598, 10599, 10604, 10605, 10629, 10657, 10658, 10685, 10696, 10725, 10743, 10772, 10775, 10843, 10844, 10846, 10866, 10898, 10942, 10943, 10954, 11015, 11036, 11052, 11055, 11056, 11078, 11084, 11091, 11109, 11144, 11175, 11187, 11205, 11237, 11248, 11270, 11310, 11318, 11332, 11335, 11358, 11370, 11372, 11403, 11450, 11453, 11462, 11471, 11516, 11517, 11518, 11542, 11565, 11566, 11604, 11619, 11662, 11676, 11700, 11743, 11745, 11799, 11835, 11862, 11864, 11885, 11901, 11915, 11971, 11973, 11974, 11975, 11976, 11998, 12002, 12019, 12026, 12034, 12040, 12072, 12073, 12083, 12084, 12125, 12126, 12151, 12153, 12176, 12195, 12200, 12213, 12215, 12230, 12247, 12248, 12281, 12283, 12287, 12307, 12308, 12317, 12379, 12381, 12405, 12410, 12456, 12460, 12474, 12492, 12526, 12539, 12577, 12589, 12604, 12605, 12636, 12656, 12665, 12692, 12693, 12702, 12723, 12726, 12836, 12848, 12851, 12891, 12898, 12901, 12910, 12911, 12913, 12920, 12932, 12937, 12938, 12939, 12953, 12998, 13000, 13001, 13021, 13022, 13034, 13042, 13043, 13054, 13062, 13063, 13089, 13107, 13116, 13129, 13154, 13159, 13169, 13196, 13204, 13207, 13238, 13239, 13256, 13353, 13354, 13355, 13399, 13406, 13407, 13432, 13440, 13442, 13443, 13463, 13493, 13514, 13542, 13562, 13603, 13651, 13653, 13659, 13670, 13681, 13683, 13691, 13700, 13766, 13773, 13779, 13782, 13783, 13790, 13814, 13834, 13835, 13885, 13925, 13926, 13940, 13945, 13964, 13969, 13997, 14016, 14021, 14029, 14031, 14038, 14043, 14057, 14067, 14106, 14119, 14131, 14135, 14136, 14152, 14173, 14174, 14175, 14196, 14199, 14200, 14302, 14341, 14344, 14347, 14352, 14353, 14357, 14403, 14413, 14490, 14539, 14576, 14580, 14586, 14599, 14606, 14649, 14654, 14683, 14755, 14756, 14766, 14779, 14785, 14790, 14803, 14832, 14845, 14891, 14899, 14900, 14901, 14916, 14929, 14935, 14946, 14993, 15051, 15091, 15102, 15173, 15185, 15207, 15208, 15291, 15302, 15361, 15373, 15376, 15377, 15386, 15392, 15416, 15468, 15526, 15527, 15533, 15543, 15562, 15577, 15591, 15592, 15612, 15644, 15692, 15695, 15699, 15707, 15708, 15725, 15751, 15754, 15773, 15788, 15824, 15832, 15882, 15889, 15913, 15914, 15924, 15925, 15966, 15970, 15974, 15979, 16016, 16061, 16065, 16154, 16167, 16177, 16190, 16199, 16202, 16207, 16215, 16240, 16241, 16242, 16243, 16294, 16329, 16400, 16401, 16408, 16426, 16437, 16443, 16444, 16447, 16475, 16479, 16500, 16501, 16511, 16545, 16546, 16599, 16637, 16666, 16669, 16731, 16795, 16799, 16855, 16856, 16895, 16922, 16923, 16948, 16950, 16953, 17025, 17029, 17043, 17044, 17071, 17081, 17083, 17088, 17103, 17136, 17216, 17235, 17364, 17365, 17367, 17387, 17425, 17430, 17441, 17463, 17464, 17468, 17487, 17497, 17498, 17525, 17529, 17533, 17578, 17665, 17674, 17678, 17692, 17726, 17727, 17728, 17734, 17738, 17739, 17742, 17798, 17821, 17831, 17837, 17896, 17903, 17914, 17925, 17954, 17955, 17957, 17974, 18019, 18022, 18053, 18060, 18115, 18116, 18141, 18184, 18189, 18206, 18218, 18226, 18237, 18239, 18262, 18267, 18317, 18364, 18371, 18372, 18390, 18391, 18402, 18405, 18409, 18439, 18458, 18462, 18468, 18495, 18511, 18522, 18532, 18539, 18540, 18547, 18548, 18597, 18626, 18632, 18689, 18728, 18734, 18739, 18742, 18752, 18788, 18828, 18834, 18835, 18842, 18843, 18887, 18903, 18910, 18914, 18938, 18965, 18968, 19015, 19023, 19038, 19053, 19060, 19068, 19080, 19081, 19094, 19096, 19123, 19124, 19199, 19212, 19230, 19261, 19303, 19327, 19365, 19381, 19382, 19386, 19388, 19404, 19433, 19437, 19446, 19488, 19489, 19497, 19498, 19541, 19549, 19552, 19592, 19602, 19649, 19679, 19735, 19792, 19804, 19809, 19810, 19811, 19814, 19821, 19832, 19838, 19919, 19944, 19965, 19979, 20008, 20042, 20043, 20047, 20048, 20055, 20058, 20061, 20097, 20105, 20110, 20111, 20143, 20147, 20152, 20157, 20158, 20175, 20216, 20241, 20248, 20266, 20271, 20277, 20278, 20297, 20362, 20376, 20395, 20405, 20410, 20425, 20432, 20439, 20445, 20468, 20495, 20496, 20497, 20505, 20514, 20520, 20523, 20540, 20542, 20543, 20575, 20610, 20628, 20630, 20635, 20636, 20648, 20653, 20686, 20713, 20723, 20725, 20728, 20731, 20756, 20778, 20836, 20874, 20919, 20920, 20930, 20933, 20960, 20968, 20971, 20973, 20988, 20990, 21013, 21044, 21134, 21138, 21173, 21216, 21262, 21277, 21292, 21342, 21344, 21345, 21346, 21352, 21434, 21472, 21477, 21500, 21501, 21538, 21541, 21573, 21574, 21575, 21576, 21599, 21657, 21673, 21680, 21714, 21715, 21719, 21784, 21794, 21821, 21851, 21857, 21867, 21878, 21888, 21915, 21955, 22011, 22054, 22056, 22075, 22087, 22131, 22179, 22218, 22272, 22274, 22276, 22284, 22314, 22335, 22341, 22343, 22347, 22348, 22383, 22414, 22424, 22433, 22436, 22453, 22462, 22492, 22631, 22652, 22696, 22730, 22731, 22732, 22733, 22734, 22744, 22746, 22796, 22807, 22814, 22817, 22847, 22859, 22866, 22917, 22941, 22949, 22976, 22987, 22992, 23024, 23047, 23078, 23093, 23096, 23097, 23124, 23125, 23154, 23159, 23226, 23241, 23255, 23256, 23264, 23265, 23270, 23271, 23272, 23276, 23281, 23282, 23284, 23321, 23398, 23403, 23404, 23442, 23444, 23473, 23515, 23539, 23562, 23573, 23605, 23624, 23639, 23661, 23687, 23779, 23781, 23808, 23817, 23822, 23844, 23857, 23861, 23885, 23906, 23957, 24021, 24022, 24046, 24057, 24111, 24121, 24129, 24158, 24171, 24187, 24243, 24268, 24296, 24354, 24358, 24361, 24378, 24401, 24403, 24472, 24511, 24524, 24548, 24586, 24589, 24627, 24664, 24669, 24680, 24685, 24693, 24737, 24776, 24789, 24801, 24807, 24825, 24828, 24836, 24837, 24861, 24880, 24904, 24915, 24931, 24949, 24981, 24997, 25000, 25001, 25023, 25044, 25081, 25084, 25087, 25106, 25113, 25114, 25149, 25213, 25224, 25287, 25307, 25314, 25351, 25384, 25385, 25392, 25400, 25414, 25415, 25418, 25430, 25435, 25450, 25470, 25487, 25500, 25506, 25512, 25513, 25528, 25529, 25542, 25580, 25583, 25589, 25590, 25600, 25611, 25645, 25647, 25680, 25682, 25697, 25719, 25740, 25759, 25819, 25849, 25853, 25860, 25866, 25867, 25877, 25886, 25887, 25900, 25907, 25912, 25963, 25976, 25977, 26033, 26034, 26088, 26109, 26116, 26117, 26119, 26122, 26136, 26141, 26162, 26198, 26199, 26222, 26243, 26246, 26248, 26251, 26256, 26264, 26278, 26285, 26286, 26287, 26350, 26354, 26374, 26375, 26379, 26380, 26383, 26404, 26413, 26441, 26459, 26479, 26496, 26541, 26552, 26569, 26630, 26690, 26691, 26713, 26716, 26717, 26720, 26721, 26722, 26729, 26741, 26764, 26778, 26797, 26828, 26859, 26976, 26978, 26979, 26980, 27002, 27026, 27050, 27085, 27204, 27205, 27208, 27233, 27286, 27287, 27303, 27325, 27326, 27351, 27358, 27390, 27411, 27420, 27421, 27424, 27469, 27478, 27495, 27496, 27508, 27510, 27519, 27521, 27538, 27546, 27549, 27550, 27566, 27619, 27641, 27643, 27686, 27687, 27688, 27706, 27727, 27739, 27771, 27795, 27817, 27827, 27851, 27869, 27883, 27884, 27886, 27963, 27964, 27968, 27999, 28037, 28039, 28094, 28106, 28134, 28135, 28136, 28143, 28145, 28152, 28218, 28219, 28220, 28234, 28306, 28330, 28337, 28339, 28367, 28379, 28381, 28398, 28410, 28411, 28427, 28435, 28437, 28490, 28546, 28561, 28573, 28582, 28586, 28587, 28592, 28593, 28597, 28598, 28618, 28619, 28623, 28633, 28639, 28644, 28673, 28681, 28682, 28683, 28686, 28717, 28721, 28754, 28758, 28775, 28796, 28798, 28807, 28808, 28859, 28863, 28881, 28899, 28911, 28912, 28913, 28920, 28967, 28994, 29000, 29002, 29019, 29036, 29050, 29081, 29087, 29139, 29140, 29150, 29192, 29194, 29203, 29208, 29216, 29219, 29220, 29222, 29233, 29238, 29262, 29270, 29312, 29331, 29335, 29350, 29371, 29372, 29414, 29416, 29426, 29430, 29477, 29525, 29532, 29573, 29592, 29619, 29620, 29635, 29694, 29704, 29705, 29706, 29708, 29752, 29771, 29774, 29782, 29796, 29821, 29825, 29828, 29862, 29863, 29874, 29878, 29879, 29891, 29892, 29894, 29895, 29921, 29923, 29935, 29939, 29940, 29948, 29978, 29985, 29991, 29994, 29998, 30013, 30025, 30026, 30052, 30099, 30110, 30114, 30115, 30125, 30189, 30196, 30216, 30227, 30288, 30294, 30303, 30317, 30371, 30402, 30406, 30408, 30449, 30450, 30560, 30567, 30588, 30615, 30647, 30670, 30687, 30728, 30729, 30730, 30780, 30781, 30804, 30806, 30823, 30825, 30830, 30832, 30833, 30865, 30878, 30895, 30901.
  warnings.warn(message)
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(&#39;WARNING: &#39;, 11, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 44, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 46, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 52, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 53, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 66, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 71, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 140, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 156, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 175, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 185, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 189, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 195, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 209, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 219, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 292, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 293, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 333, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 342, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 359, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 398, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 425, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 432, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 436, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 452, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 477, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 480, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 481, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 521, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 537, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 582, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 596, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 597, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 599, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 627, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 629, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 654, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 656, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 688, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 804, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 841, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 860, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 896, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 936, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 975, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1001, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1010, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1074, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1140, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1149, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1181, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1182, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1183, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1185, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1186, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1197, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1198, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1218, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1227, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1228, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1229, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1230, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1272, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1273, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1284, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1294, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1296, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1300, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1346, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1357, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1386, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1408, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1413, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1489, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1502, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1503, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1509, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1518, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1519, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1521, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1541, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1564, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1595, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1603, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1612, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1707, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1710, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1711, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1754, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1868, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1870, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1874, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1884, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1894, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1921, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1942, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1943, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1953, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1955, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1956, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1957, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1965, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1969, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1981, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 1985, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2032, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2036, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2067, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2105, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2120, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2121, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2125, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2126, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2133, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2166, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2187, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2206, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2217, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2220, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2226, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2228, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2280, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2325, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2337, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2352, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2372, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2386, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2435, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2449, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2457, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2473, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2480, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2492, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2515, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2533, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2560, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2562, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2570, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2584, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2587, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2596, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2607, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2710, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2711, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2733, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2742, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2756, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2765, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2781, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2817, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2819, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2820, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2828, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2851, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2864, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2868, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2874, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2887, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2890, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2891, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2892, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2893, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2894, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2918, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2924, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2926, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2942, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2957, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2962, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 2980, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3022, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3025, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3026, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3054, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3057, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3117, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3140, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3142, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3143, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3146, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3174, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3203, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3238, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3284, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3308, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3309, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3315, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3340, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3341, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3342, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3356, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3374, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3384, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3389, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3432, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3529, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3536, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3550, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3551, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3557, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3582, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3595, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3616, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3644, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3645, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3680, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3689, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3696, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3724, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3752, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3771, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3777, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3783, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3788, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3830, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3831, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3832, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3859, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3915, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3916, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3988, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 3998, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4011, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4036, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4041, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4042, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4067, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4068, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4069, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4080, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4097, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4098, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4123, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4135, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4196, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4203, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4204, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4218, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4220, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4224, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4230, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4231, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4232, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4246, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4251, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4257, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4258, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4282, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4287, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4292, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4387, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4393, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4398, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4417, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4446, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4475, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4498, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4504, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4516, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4548, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4574, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4579, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4604, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4616, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4622, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4623, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4647, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4648, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4656, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4661, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4667, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4680, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4699, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4718, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4765, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4778, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4807, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4820, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4850, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4868, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4877, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4878, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4879, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4888, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4921, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4948, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4957, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4958, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4971, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4983, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 4984, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5005, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5030, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5031, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5039, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5042, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5083, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5089, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5091, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5135, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5139, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5154, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5168, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5173, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5184, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5192, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5226, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5279, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5288, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5305, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5306, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5310, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5337, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5383, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5403, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5424, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5451, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5495, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5500, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5549, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5553, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5585, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5589, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5632, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5679, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5692, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5693, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5695, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5717, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5760, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5866, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5872, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5962, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5982, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5989, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 5991, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6004, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6005, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6018, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6047, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6053, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6055, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6064, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6141, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6206, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6210, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6211, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6240, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6251, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6262, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6264, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6292, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6328, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6331, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6332, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6350, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6360, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6391, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6394, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6441, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6442, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6448, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6452, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6458, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6469, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6484, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6508, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6511, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6525, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6537, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6568, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6585, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6600, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6640, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6683, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6684, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6686, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6687, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6702, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6711, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6723, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6742, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6757, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6774, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6812, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6816, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6826, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6848, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6863, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6873, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6896, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6934, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6969, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6970, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6971, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 6989, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7014, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7049, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7050, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7051, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7087, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7093, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7105, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7166, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7167, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7173, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7212, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7235, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7240, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7265, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7274, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7275, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7304, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7350, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7351, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7359, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7363, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7378, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7386, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7387, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7453, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7466, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7468, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7476, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7487, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7504, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7564, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7568, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7569, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7597, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7616, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7617, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7638, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7641, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7642, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7644, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7648, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7649, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7650, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7651, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7665, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7666, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7673, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7690, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7693, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7704, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7708, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7760, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7774, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7775, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7781, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7801, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7802, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7811, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7812, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7813, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7814, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7831, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7854, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7858, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7920, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7965, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 7966, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8006, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8012, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8013, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8024, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8025, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8031, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8038, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8078, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8079, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8097, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8113, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8128, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8133, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8140, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8188, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8193, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8215, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8246, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8249, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8250, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8252, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8253, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8258, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8290, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8303, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8314, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8337, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8338, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8362, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8368, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8410, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8476, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8477, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8489, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8490, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8509, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8516, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8523, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8533, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8543, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8563, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8637, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8672, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8679, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8722, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8723, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8739, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8744, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8798, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8811, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8840, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8878, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8896, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8917, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8927, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8928, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8978, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 8988, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9024, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9047, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9052, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9083, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9085, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9099, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9196, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9211, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9219, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9220, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9226, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9270, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9296, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9297, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9299, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9325, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9342, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9399, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9406, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9412, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9413, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9437, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9475, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9480, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9486, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9522, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9536, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9544, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9546, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9562, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9566, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9567, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9648, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9656, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9663, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9666, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9677, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9686, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9688, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9690, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9761, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9773, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9781, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9788, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9879, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9894, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9931, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9939, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9942, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9943, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 9955, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10004, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10037, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10043, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10084, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10089, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10113, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10157, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10162, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10163, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10189, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10192, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10229, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10255, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10289, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10296, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10320, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10333, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10380, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10441, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10444, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10445, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10446, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10448, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10455, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10483, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10494, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10495, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10496, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10505, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10527, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10528, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10543, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10598, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10599, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10604, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10605, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10629, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10657, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10658, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10685, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10696, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10725, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10743, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10772, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10775, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10843, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10844, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10846, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10866, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10898, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10942, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10943, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 10954, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11015, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11036, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11052, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11055, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11056, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11078, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11084, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11091, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11109, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11144, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11175, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11187, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11205, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11237, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11248, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11270, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11310, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11318, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11332, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11335, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11358, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11370, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11372, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11403, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11450, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11453, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11462, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11471, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11516, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11517, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11518, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11542, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11565, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11566, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11604, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11619, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11662, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11676, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11700, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11743, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11745, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11799, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11835, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11862, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11864, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11901, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11915, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11971, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11973, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11974, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11975, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11976, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 11998, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12002, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12019, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12026, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12034, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12040, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12072, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12073, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12083, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12084, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12125, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12126, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12151, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12153, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12176, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12195, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12200, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12213, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12215, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12230, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12247, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12248, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12281, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12283, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12287, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12307, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12308, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12317, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12379, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12381, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12405, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12410, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12456, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12460, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12474, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12492, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12526, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12539, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12577, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12589, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12604, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12605, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12636, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12656, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12665, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12692, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12693, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12702, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12723, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12726, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12836, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12848, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12851, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12891, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12898, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12901, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12910, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12911, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12913, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12920, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12932, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12937, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12938, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12939, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12953, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 12998, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13000, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13001, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13021, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13022, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13034, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13042, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13043, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13054, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13062, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13063, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13089, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13107, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13116, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13129, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13154, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13159, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13169, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13196, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13204, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13207, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13238, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13239, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13256, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13353, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13354, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13355, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13399, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13406, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13407, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13432, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13440, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13442, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13443, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13463, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13493, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13514, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13542, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13562, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13603, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13651, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13653, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13659, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13670, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13681, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13683, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13691, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13700, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13766, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13773, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13779, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13782, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13783, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13790, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13814, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13834, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13835, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13925, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13926, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13940, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13945, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13964, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13969, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 13997, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14016, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14021, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14029, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14031, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14038, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14043, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14057, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14067, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14106, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14119, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14131, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14135, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14136, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14152, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14173, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14174, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14175, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14196, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14199, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14200, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14302, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14341, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14344, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14347, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14352, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14353, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14357, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14403, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14413, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14490, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14539, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14576, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14580, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14586, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14599, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14606, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14649, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14654, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14683, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14755, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14756, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14766, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14779, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14785, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14790, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14803, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14832, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14845, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14891, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14899, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14900, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14901, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14916, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14929, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14935, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14946, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 14993, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15051, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15091, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15102, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15173, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15185, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15207, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15208, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15291, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15302, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15361, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15373, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15376, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15377, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15386, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15392, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15416, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15468, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15526, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15527, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15533, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15543, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15562, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15577, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15591, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15592, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15612, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15644, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15692, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15695, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15699, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15707, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15708, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15725, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15751, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15754, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15773, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15788, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15824, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15832, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15882, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15889, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15913, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15914, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15924, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15925, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15966, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15970, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15974, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 15979, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16016, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16061, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16065, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16154, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16167, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16177, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16190, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16199, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16202, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16207, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16215, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16240, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16241, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16242, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16243, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16294, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16329, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16400, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16401, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16408, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16426, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16437, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16443, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16444, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16447, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16475, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16479, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16500, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16501, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16511, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16545, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16546, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16599, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16637, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16666, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16669, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16731, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16795, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16799, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16855, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16856, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16895, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16922, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16923, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16948, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16950, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 16953, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17025, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17029, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17043, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17044, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17071, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17081, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17083, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17088, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17103, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17136, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17235, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17364, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17365, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17367, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17387, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17425, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17430, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17441, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17463, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17464, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17468, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17487, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17497, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17498, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17525, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17529, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17533, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17578, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17665, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17674, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17678, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17692, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17726, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17727, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17728, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17734, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17738, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17739, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17742, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17798, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17821, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17831, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17837, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17896, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17903, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17914, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17925, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17954, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17955, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17957, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 17974, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18019, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18022, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18053, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18060, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18115, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18116, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18141, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18184, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18189, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18206, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18218, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18226, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18237, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18239, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18262, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18267, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18317, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18364, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18371, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18372, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18390, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18391, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18402, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18405, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18409, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18439, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18458, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18462, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18468, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18495, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18511, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18522, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18532, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18539, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18540, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18547, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18548, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18597, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18626, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18632, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18689, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18728, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18734, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18739, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18742, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18752, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18788, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18828, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18834, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18835, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18842, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18843, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18887, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18903, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18910, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18914, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18938, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18965, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18968, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19015, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19023, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19038, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19053, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19060, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19068, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19080, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19081, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19094, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19096, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19123, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19124, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19199, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19212, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19230, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19261, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19303, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19327, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19365, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19381, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19382, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19386, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19388, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19404, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19433, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19437, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19446, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19488, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19489, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19497, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19498, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19541, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19549, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19552, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19592, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19602, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19649, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19679, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19735, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19792, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19804, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19809, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19810, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19811, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19814, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19821, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19832, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19838, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19919, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19944, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19965, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 19979, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20008, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20042, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20043, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20047, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20048, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20055, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20058, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20061, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20097, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20105, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20110, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20111, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20143, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20147, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20152, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20157, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20158, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20175, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20241, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20248, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20266, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20271, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20277, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20278, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20297, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20362, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20376, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20395, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20405, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20410, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20425, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20432, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20439, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20445, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20468, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20495, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20496, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20497, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20505, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20514, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20520, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20523, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20540, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20542, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20543, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20575, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20610, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20628, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20630, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20635, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20636, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20648, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20653, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20686, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20713, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20723, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20725, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20728, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20731, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20756, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20778, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20836, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20874, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20919, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20920, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20930, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20933, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20960, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20968, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20971, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20973, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20988, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 20990, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21013, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21044, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21134, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21138, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21173, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21262, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21277, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21292, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21342, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21344, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21345, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21346, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21352, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21434, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21472, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21477, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21500, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21501, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21541, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21573, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21574, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21575, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21576, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21599, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21657, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21673, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21680, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21714, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21715, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21719, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21784, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21794, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21821, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21851, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21857, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21867, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21878, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21888, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21915, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 21955, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22011, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22054, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22056, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22075, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22087, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22131, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22179, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22218, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22272, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22274, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22276, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22284, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22314, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22335, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22341, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22343, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22347, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22348, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22383, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22414, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22424, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22433, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22436, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22453, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22462, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22492, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22631, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22652, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22696, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22730, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22731, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22732, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22733, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22734, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22744, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22746, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22796, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22807, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22814, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22817, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22847, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22859, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22866, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22917, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22941, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22949, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22976, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22987, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 22992, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23024, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23047, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23078, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23093, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23096, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23097, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23124, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23125, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23154, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23159, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23226, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23241, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23255, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23256, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23264, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23265, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23270, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23271, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23272, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23276, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23281, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23282, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23284, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23321, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23398, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23403, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23404, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23442, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23444, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23473, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23515, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23539, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23562, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23573, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23605, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23624, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23639, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23661, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23687, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23779, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23781, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23808, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23817, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23822, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23844, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23857, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23861, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23906, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 23957, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24021, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24022, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24046, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24057, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24111, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24121, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24129, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24158, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24171, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24187, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24243, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24268, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24296, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24354, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24358, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24361, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24378, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24401, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24403, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24472, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24511, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24524, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24548, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24586, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24589, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24627, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24664, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24669, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24680, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24685, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24693, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24737, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24776, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24789, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24801, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24807, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24825, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24828, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24836, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24837, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24861, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24880, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24904, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24915, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24931, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24949, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24981, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24997, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25000, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25001, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25023, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25044, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25081, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25084, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25087, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25106, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25113, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25114, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25149, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25213, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25224, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25287, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25307, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25314, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25351, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25384, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25385, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25392, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25400, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25414, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25415, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25418, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25430, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25435, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25450, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25470, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25487, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25500, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25506, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25512, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25513, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25528, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25529, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25542, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25580, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25583, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25589, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25590, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25600, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25611, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25645, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25647, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25680, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25682, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25697, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25719, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25740, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25759, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25819, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25849, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25853, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25860, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25866, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25867, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25877, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25886, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25887, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25900, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25907, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25912, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25963, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25976, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 25977, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26033, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26034, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26088, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26109, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26116, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26117, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26119, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26122, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26136, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26141, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26162, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26198, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26199, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26222, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26243, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26246, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26248, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26251, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26256, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26264, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26278, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26285, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26286, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26287, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26350, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26354, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26374, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26375, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26379, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26380, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26383, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26404, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26413, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26441, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26459, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26479, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26496, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26541, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26552, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26569, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26630, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26690, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26691, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26713, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26716, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26717, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26720, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26721, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26722, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26729, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26741, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26764, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26778, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26797, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26828, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26859, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26976, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26978, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26979, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 26980, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27002, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27026, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27050, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27085, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27204, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27205, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27208, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27233, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27286, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27287, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27303, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27325, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27326, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27351, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27358, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27390, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27411, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27420, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27421, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27424, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27469, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27478, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27495, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27496, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27508, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27510, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27519, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27521, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27538, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27546, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27549, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27550, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27566, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27619, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27641, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27643, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27686, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27687, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27688, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27706, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27727, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27739, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27771, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27795, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27817, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27827, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27851, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27869, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27883, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27884, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27886, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27963, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27964, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27968, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27999, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28037, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28039, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28094, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28106, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28134, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28135, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28136, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28143, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28145, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28152, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28218, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28219, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28220, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28234, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28306, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28330, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28337, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28339, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28367, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28379, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28381, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28398, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28410, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28411, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28427, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28435, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28437, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28490, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28546, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28561, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28573, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28582, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28586, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28587, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28592, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28593, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28597, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28598, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28618, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28619, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28623, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28633, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28639, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28644, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28673, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28681, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28682, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28683, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28686, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28717, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28721, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28754, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28758, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28775, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28796, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28798, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28807, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28808, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28859, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28863, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28881, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28899, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28911, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28912, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28913, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28920, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28967, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 28994, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29000, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29002, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29019, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29036, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29050, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29081, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29087, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29139, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29140, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29150, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29192, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29194, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29203, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29208, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29219, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29220, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29222, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29233, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29238, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29262, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29270, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29312, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29331, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29335, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29350, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29371, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29372, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29414, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29416, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29426, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29430, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29477, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29525, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29532, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29573, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29592, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29619, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29620, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29635, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29694, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29704, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29705, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29706, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29708, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29752, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29771, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29774, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29782, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29796, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29821, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29825, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29828, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29862, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29863, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29874, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29878, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29879, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29891, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29892, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29894, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29895, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29921, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29923, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29935, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29939, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29940, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29948, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29978, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29985, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29991, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29994, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 29998, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30013, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30025, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30026, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30052, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30099, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30110, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30114, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30115, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30125, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30189, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30196, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30216, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30227, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30288, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30294, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30303, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30317, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30371, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30402, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30406, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30408, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30449, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30450, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30560, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30567, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30588, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30615, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30647, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30670, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30687, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30728, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30729, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30730, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30780, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30781, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30804, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30806, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30823, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30825, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30830, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30832, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30833, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30865, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30878, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30895, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 30901, &#39; is an island (no neighbors)&#39;)
</pre></div>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/libpysal/weights/weights.py:172: UserWarning: The weights matrix is not fully connected: 
 There are 13 disconnected components.
 There are 10 islands with ids: 11563, 18112, 24885, 27089, 37460, 42477, 47994, 49645, 59851, 66131.
  warnings.warn(message)
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(&#39;WARNING: &#39;, 11563, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 18112, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 24885, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 27089, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 37460, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 42477, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 47994, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 49645, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 59851, &#39; is an island (no neighbors)&#39;)
(&#39;WARNING: &#39;, 66131, &#39; is an island (no neighbors)&#39;)
</pre></div>
</div>
</div>
</div>
<p>To make things handier later, we grab the names of the lagged variables separately:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w_class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;w_&#39;</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Spatially lagging the split chips will give rise to islands (chips that do not have any neighbors). This will mean later on, when we consolidate the table for models, we will have to drop island observations and, if there is a systematic bias in the group (train/val) where we drop more, it might induce further issues down the line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span>
    <span class="n">lag_all</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">train_all</span><span class="o">=</span><span class="n">db_all</span><span class="p">[</span><span class="s1">&#39;train_all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;Validation&quot;</span><span class="p">})</span>
    <span class="p">),</span> 
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;card&#39;</span><span class="p">,</span> 
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;train_all&#39;</span><span class="p">,</span> 
    <span class="n">element</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span>
    <span class="n">aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">3</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/sp_model_chip_probabilities_36_01.png" src="../_images/sp_model_chip_probabilities_36_01.png" />
</div>
</div>
<p>Cardinalities clearly differ: trainining observations (a larger group) has more neighbors on average. This is potentially a problem in that the validation set is <em>not</em> mimmicking the training one. However, the direction of the difference might be such that evaluation metrics could be taken as a <em>lower</em> bound: the model is trained using more information from context but evaluated with less; performance will be evaluated with “worse” conditions than it’s been trained on so, everything else being equal, it’d give lower scores than the model actually should.</p>
<p><strong>DA-B</strong>: discuss with MF it is the case</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">corrs</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">build_prob_wprob_corrs</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="n">w_class_names</span><span class="p">,</span> <span class="n">db_all</span><span class="p">,</span> <span class="n">lag_all</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As an exploration, here we have the correlation between high probability in a given class, and high probability in other classes in the spatial lag (geographic context). There is a clear pattern of non-zero correlations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corrs</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/sp_model_chip_probabilities_40_01.png" src="../_images/sp_model_chip_probabilities_40_01.png" />
</div>
</div>
</div>
<div class="section" id="block-split-lag">
<h4>Block Split lag<a class="headerlink" href="#block-split-lag" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">[TBA]</span></code></p>
</div>
</div>
<div class="section" id="interaction-variables">
<h3>Interaction variables<a class="headerlink" href="#interaction-variables" title="Permalink to this headline">¶</a></h3>
<p>Here we develop a set of interaction variables between the probability of each class and their spatial lag. In mathematical terms, the expected probability <span class="math notranslate nohighlight">\(\mu_i\)</span> for chip <span class="math notranslate nohighlight">\(i\)</span> in our base model is:</p>
<div class="math notranslate nohighlight">
\[
\mu_i = \alpha + \sum_k  P_{ki} \beta_k
\]</div>
<p>When we include the spatial lag, this becomes:</p>
<div class="math notranslate nohighlight">
\[
\mu_i = \alpha + \sum_k  P_{ki} \beta_k + \sum_k WP_{ki} \gamma_k
\]</div>
<p>The idea with interactions is to model the probability expectation as:</p>
<div class="math notranslate nohighlight">
\[
\mu_i = \alpha + \sum_k  P_{ki} \beta_k + \sum_k WP_{ki} \gamma_k + \sum_k \sum_k P_{ki} \times WP_{ki} \delta_{kk}
\]</div>
<p>Here we build a method to construct the last term in the equation above (<span class="math notranslate nohighlight">\(\sum_k \sum_k P_{ki} \times WP_{ki}\)</span>), which will be used when fitting some of the models below:</p>
</div>
<div class="section" id="build-db">
<h3>Build <code class="docutils literal notranslate"><span class="pre">db</span></code><a class="headerlink" href="#build-db" title="Permalink to this headline">¶</a></h3>
<p>Finally, we bring together in a single, clean table information on the original probabilities, their spatial lags, and class label. To make sure it is analysis-ready, we retain only single-class chips that are <em>not</em> islands (i.e., have at least one neighbor).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">db_all</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">lag_all</span>
<span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="s1">&#39;(single_class == True) &amp; (island == False)&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;single_class&#39;</span><span class="p">,</span> <span class="s1">&#39;island&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The dropping of observations that happened above might also induce additional biases.</p>
<p><strong>DA-B</strong> Explore further the distribution of values between train/val sets (e.g. heatmaps/hists before the split and after)</p>
</div>
<div class="section" id="extract-train-val-indices">
<h3>Extract train/val indices<a class="headerlink" href="#extract-train-val-indices" title="Permalink to this headline">¶</a></h3>
<p>Now we have the set ready, we can pick out train/val indices as the modeling will expect them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_ids</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all == True&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">val_ids</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all == False&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="class-im-balance">
<h3>Class (im)balance<a class="headerlink" href="#class-im-balance" title="Permalink to this headline">¶</a></h3>
<p>The spatial lag step might be introducing bias in the sample before modelling. We pick all the single class chips and split them randomly between train and validation. If spatially lagging has a systematic effect on some classes (e.g., some classes get dropped more often), this might introduce bias that will make our model scoress unreliable. To explore this case, we want to get an idea of:</p>
<ul class="simple">
<li><p>[x] Overall proportion of train/val before (<code class="docutils literal notranslate"><span class="pre">db_all</span></code> single class) and after spatially lagging (<code class="docutils literal notranslate"><span class="pre">db</span></code>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;before_lag&#39;</span><span class="p">:</span> <span class="n">db_all</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;single_class&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span>
            <span class="s1">&#39;train_all&#39;</span>
        <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">db_all</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;single_class&#39;</span><span class="p">)),</span>
        <span class="s1">&#39;after_lag&#39;</span><span class="p">:</span> <span class="n">db</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;Training&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;Validation&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>before_lag</th>
      <th>after_lag</th>
    </tr>
    <tr>
      <th>train_all</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Training</th>
      <td>70.116082</td>
      <td>71.35183</td>
    </tr>
    <tr>
      <th>Validation</th>
      <td>29.883918</td>
      <td>28.64817</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>[x] Poportion by class in the set before spatially lagging and after –&gt; <code class="docutils literal notranslate"><span class="pre">Fig.</span> <span class="pre">Balance</span> <span class="pre">(b)</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;before_lag&#39;</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span>
            <span class="n">db_all</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;single_class&#39;</span><span class="p">)[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">db_all</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;single_class&#39;</span><span class="p">)),</span>
        <span class="s1">&#39;after_lag&#39;</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span>
            <span class="n">db</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fig. Balance (b)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/sp_model_chip_probabilities_56_01.png" src="../_images/sp_model_chip_probabilities_56_01.png" />
</div>
</div>
</div>
</div>
<div class="section" id="single-class-models">
<h2>Single class models<a class="headerlink" href="#single-class-models" title="Permalink to this headline">¶</a></h2>
<p>Models to evaluate:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm / Features</p></th>
<th class="head"><p>Baseline</p></th>
<th class="head"><p>Baseline + <span class="math notranslate nohighlight">\(WX\)</span></p></th>
<th class="head"><p>Baseline + <span class="math notranslate nohighlight">\(WX\)</span> + <span class="math notranslate nohighlight">\(X\times WX\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max. Prob</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mp_res</span></code></p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Logit ensemble</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">logite_baseline_res</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">logite_wx_res</span></code></p></td>
<td><p>Singular matrix</p></td>
</tr>
<tr class="row-even"><td><p>MNLogit</p></td>
<td><p>Does not converge</p></td>
<td><p>Does not converge</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Random Forest</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rf_baseline_res</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rf_wx_res</span></code></p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>XGBoost</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hbgb_baseline_res</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hbgb_wx_res</span></code></p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
<p>Evaluation workflow:</p>
<ol class="simple">
<li><p>Split train/validation randomly (e.g., 70/30)</p></li>
<li><p>Fit model on train subset</p></li>
<li><p>Obtain <code class="docutils literal notranslate"><span class="pre">perf_</span></code> measures on validation subset</p></li>
<li><p>Fill <code class="docutils literal notranslate"><span class="pre">results.json</span></code> file</p></li>
</ol>
<p>Format:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>{
    &quot;meta_n_class&quot;: &lt;int&gt;,
    &quot;meta_class_names&quot;: &lt;list&gt;,
    &quot;meta_trainval_counts&quot;: &lt;dict&gt;
    &quot;model_name&quot;: &lt;str&gt;,
    &quot;model_params&quot;: &lt;list&gt;,
    &quot;meta_runtime&quot;: &lt;float&gt;,
    &quot;meta_preds_path&quot;: &lt;str&gt;,
    &quot;perf_model_accuracy_train&quot;: &lt;float&gt;,
    &quot;perf_within_class_accuracy_train&quot;: &lt;list&gt;,
    &quot;perf_confusion_train&quot;: &lt;list&gt;,    
    &quot;perf_model_accuracy_val&quot;: &lt;float&gt;,
    &quot;perf_within_class_accuracy_val&quot;: &lt;list&gt;,
    &quot;perf_confusion_val&quot;: &lt;list&gt;,
    &quot;notes&quot;: &lt;str&gt;,
}
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res_path</span> <span class="o">=</span> <span class="s1">&#39;/home/jovyan/data/spatial_signatures/chip_probs/model_outputs/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Flush <code class="docutils literal notranslate"><span class="pre">db</span></code> to disk for availability later on:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res_path</span><span class="p">,</span> <span class="s1">&#39;db.pq&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/tmp/ipykernel_1597682/473553071.py:1: UserWarning: this is an initial implementation of Parquet/Feather file support and associated metadata.  This is tracking version 0.1.0 of the metadata specification at https://github.com/geopandas/geo-arrow-spec

This metadata specification does not yet make stability promises.  We do not yet recommend using this in a production setting unless you are able to rewrite your Parquet/Feather files.

To further ignore this warning, you can do: 
import warnings; warnings.filterwarnings('ignore', message='.*initial implementation of Parquet.*')
  db.to_parquet(os.path.join(res_path, 'db.pq'))
</pre>
</div>
</div>
</div>
<div class="section" id="max-probability">
<h3>Max. Probability<a class="headerlink" href="#max-probability" title="Permalink to this headline">¶</a></h3>
<p>This is a baseline that selects as predicted category that which displays the highest probability as stored in <code class="docutils literal notranslate"><span class="pre">probs</span></code>. We can consider this the baseline upon which other models will improve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mp_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_maxprob</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">train_ids</span><span class="p">,</span> <span class="n">val_ids</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="logit-ensemble">
<h3>Logit ensemble<a class="headerlink" href="#logit-ensemble" title="Permalink to this headline">¶</a></h3>
<p>Our approach here consists on fitting individual logistic regressions to predict each class against all other ones. With these models, we obtain a probability for each class, and pick that with the largest one as the predicted class.</p>
<hr class="docutils" />
<p><strong>NOTE (DA-B)</strong>: this might not be right if different logits have different distribution of probabilities. Maybe replace the probability by the rank and pick the largest rank as the predicted class?</p>
<hr class="docutils" />
<p>Two methods, <code class="docutils literal notranslate"><span class="pre">logite_fit</span></code> to fit each class model, and <code class="docutils literal notranslate"><span class="pre">logite_predict</span></code> to generate predicted classes from set of arbitrary features.</p>
<div class="section" id="baseline">
<h4>Baseline<a class="headerlink" href="#baseline" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>
<span class="n">reload</span><span class="p">(</span><span class="n">tools</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logite_baseline_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_logite</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">train_ids</span><span class="p">,</span> <span class="n">val_ids</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:258: UserWarning: Numerical issues were encountered when scaling the data and might not be solved. The standard deviation of the data is probably very close to 0. 
  warnings.warn(
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.680899
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.653074
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.685377
         Iterations 5
Optimization terminated successfully.
         Current function value: 0.692871
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.692743
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.682253
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.692692
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.691024
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.692967
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.693131
         Iterations 3
Optimization terminated successfully.
         Current function value: 0.693139
         Iterations 3
Optimization terminated successfully.
         Current function value: 0.689146
         Iterations 4
</pre></div>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:239: UserWarning: Numerical issues were encountered when centering the data and might not be solved. Dataset may contain too large values. You may need to prescale your features.
  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:258: UserWarning: Numerical issues were encountered when scaling the data and might not be solved. The standard deviation of the data is probably very close to 0. 
  warnings.warn(
</pre>
</div>
</div>
</div>
</div>
<div class="section" id="baseline-wx">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span><a class="headerlink" href="#baseline-wx" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logite_wx_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_logite</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="s1">&#39;baseline_wx&#39;</span><span class="p">,</span> 
    <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.657119
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.604344
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.676905
         Iterations 5
Optimization terminated successfully.
         Current function value: 0.692461
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.692309
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.668075
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.692096
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.687466
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.692777
         Iterations 4
Optimization terminated successfully.
         Current function value: 0.693107
         Iterations 3
Optimization terminated successfully.
         Current function value: 0.693127
         Iterations 3
Optimization terminated successfully.
         Current function value: 0.684861
         Iterations 4
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="baseline-wx-x-times-wx">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span> + <span class="math notranslate nohighlight">\(X\times WX\)</span><a class="headerlink" href="#baseline-wx-x-times-wx" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logite_xwx_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_logite</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="s1">&#39;baseline_wx_xwx&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;model_results/&#39;</span><span class="p">,</span>
    <span class="n">scale_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">log_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">interact</span><span class="o">=</span><span class="p">(</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="n">w_class_names</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="multinomial-logit">
<h3>Multinomial Logit<a class="headerlink" href="#multinomial-logit" title="Permalink to this headline">¶</a></h3>
<p>For this we rely on <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> <a class="reference external" href="https://www.statsmodels.org/stable/examples/notebooks/generated/discrete_choice_overview.html#Multinomial-Logit">implementation</a> and fit it to the standardised log of the original probabilities to make convergence possible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_ids</span><span class="p">,</span> <span class="n">class_names</span><span class="o">+</span><span class="n">w_class_names</span><span class="p">])),</span> <span class="n">train_ids</span><span class="p">,</span> <span class="n">class_names</span><span class="o">+</span><span class="n">w_class_names</span>
<span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">mlogit_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MNLogit</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_ids</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">X_train</span><span class="p">)</span>
<span class="n">mlogit_res</span> <span class="o">=</span> <span class="n">mlogit_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>
<span class="n">reload</span><span class="p">(</span><span class="n">tools</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h4>Baseline<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mlogit_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_mlogit</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">train_ids</span><span class="p">,</span> <span class="n">val_ids</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;model_results/&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:235: UserWarning: Numerical issues were encountered when centering the data and might not be solved. Dataset may contain too large values. You may need to prescale your features.
  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:254: UserWarning: Numerical issues were encountered when scaling the data and might not be solved. The standard deviation of the data is probably very close to 0. 
  warnings.warn(
/opt/conda/lib/python3.9/site-packages/statsmodels/discrete/discrete_model.py:2299: RuntimeWarning: overflow encountered in exp
  eXB = np.column_stack((np.ones(len(X)), np.exp(X)))
/opt/conda/lib/python3.9/site-packages/statsmodels/discrete/discrete_model.py:2300: RuntimeWarning: invalid value encountered in true_divide
  return eXB/eXB.sum(1)[:,None]
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: nan
         Iterations 5
</pre></div>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:235: UserWarning: Numerical issues were encountered when centering the data and might not be solved. Dataset may contain too large values. You may need to prescale your features.
  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:254: UserWarning: Numerical issues were encountered when scaling the data and might not be solved. The standard deviation of the data is probably very close to 0. 
  warnings.warn(
</pre>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_109</span><span class="o">/</span><span class="mf">2293739738.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mlogit_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_mlogit</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">train_ids</span><span class="p">,</span> <span class="n">val_ids</span><span class="p">,</span> <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;model_results/&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="p">)</span>

<span class="nn">~/work/OneDrive - The University of Liverpool/AAA/research_liv/u-lvl/2020/ati_fellowship/code/chip_probs/chip_prob_modelling.py</span> in <span class="ni">run_mlogit</span><span class="nt">(x_name, y_name, db, train_ids, val_ids, model_name_xtra, res_path)</span>
<span class="g g-Whitespace">    </span><span class="mi">293</span>     <span class="c1"># Results</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>     <span class="n">model_name</span> <span class="o">=</span> <span class="n">build_model_name</span><span class="p">(</span><span class="s1">&#39;mlogit&#39;</span><span class="p">,</span> <span class="n">model_name_xtra</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">295</span>     <span class="n">mlogit_res</span> <span class="o">=</span> <span class="n">build_perf</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>         <span class="n">db</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_ids</span><span class="p">,</span> <span class="n">y_name</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span>         <span class="n">mlogit_pred_train</span><span class="p">,</span>

<span class="nn">~/work/OneDrive - The University of Liverpool/AAA/research_liv/u-lvl/2020/ati_fellowship/code/chip_probs/chip_prob_modelling.py</span> in <span class="ni">build_perf</span><span class="nt">(y_true_train, y_pred_train, y_true_val, y_pred_val, class_names, meta)</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span>         <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;meta_trainval_counts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">t_vc</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">v_vc</span><span class="p">[</span><span class="n">c</span><span class="p">])])</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="k">for</span> <span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">subset</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">]):</span>
<span class="ne">--&gt; </span><span class="mi">109</span>         <span class="n">meta</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;perf_model_accuracy_</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>         <span class="n">meta</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;perf_confusion_</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span>             <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">class_names</span>

<span class="nn">/opt/conda/lib/python3.9/site-packages/sklearn/metrics/_classification.py</span> in <span class="ni">accuracy_score</span><span class="nt">(y_true, y_pred, normalize, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span> 
<span class="g g-Whitespace">    </span><span class="mi">204</span>     <span class="c1"># Compute accuracy for each possible representation</span>
<span class="ne">--&gt; </span><span class="mi">205</span>     <span class="n">y_type</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">_check_targets</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>     <span class="n">check_consistent_length</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>     <span class="k">if</span> <span class="n">y_type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;multilabel&quot;</span><span class="p">):</span>

<span class="nn">/opt/conda/lib/python3.9/site-packages/sklearn/metrics/_classification.py</span> in <span class="ni">_check_targets</span><span class="nt">(y_true, y_pred)</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span>     <span class="n">check_consistent_length</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span>     <span class="n">type_true</span> <span class="o">=</span> <span class="n">type_of_target</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">86</span>     <span class="n">type_pred</span> <span class="o">=</span> <span class="n">type_of_target</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> 
<span class="g g-Whitespace">     </span><span class="mi">88</span>     <span class="n">y_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">type_true</span><span class="p">,</span> <span class="n">type_pred</span><span class="p">}</span>

<span class="nn">/opt/conda/lib/python3.9/site-packages/sklearn/utils/multiclass.py</span> in <span class="ni">type_of_target</span><span class="nt">(y)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>     <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>         <span class="c1"># [.1, .2, 3] or [[.1, .2, 3]] or [[1., .2]] and not [1., 2., 3.]</span>
<span class="ne">--&gt; </span><span class="mi">324</span>         <span class="n">_assert_all_finite</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>         <span class="k">return</span> <span class="s2">&quot;continuous&quot;</span> <span class="o">+</span> <span class="n">suffix</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span> 

<span class="nn">/opt/conda/lib/python3.9/site-packages/sklearn/utils/validation.py</span> in <span class="ni">_assert_all_finite</span><span class="nt">(X, allow_nan, msg_dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>         <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>             <span class="n">type_err</span> <span class="o">=</span> <span class="s2">&quot;infinity&quot;</span> <span class="k">if</span> <span class="n">allow_nan</span> <span class="k">else</span> <span class="s2">&quot;NaN, infinity&quot;</span>
<span class="ne">--&gt; </span><span class="mi">114</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>                 <span class="n">msg_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>                     <span class="n">type_err</span><span class="p">,</span> <span class="n">msg_dtype</span> <span class="k">if</span> <span class="n">msg_dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span>

<span class="ne">ValueError</span>: Input contains NaN, infinity or a value too large for dtype(&#39;float64&#39;).
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mlogit_wx</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_mlogit</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;model_results/&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="random-forest">
<h3>Random Forest<a class="headerlink" href="#random-forest" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rf_param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h4>Baseline<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Grid search</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span> 
<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">RandomForestClassifier</span><span class="p">(),</span>
    <span class="n">rf_param_grid</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">],</span> 
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res_path</span><span class="p">,</span> <span class="s1">&#39;RandomForestClassifier_baseline.csv&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py:702: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.
  warnings.warn(
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;max_depth&#39;: 5, &#39;max_features&#39;: 0.5, &#39;n_estimators&#39;: 100}
CPU times: user 8.91 s, sys: 662 ms, total: 9.57 s
Wall time: 23min 52s
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Model fitting</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">rf_params</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span>
<span class="k">except</span><span class="p">:</span>
    <span class="c1"># Hardcoded values based on grid search results</span>
    <span class="n">rf_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="mf">0.5</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rf_baseline_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_tree</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">rf_params</span><span class="p">),</span>
    <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> 
    <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Grid search</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">RandomForestClassifier</span><span class="p">(),</span>
    <span class="n">rf_param_grid</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">],</span> 
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res_path</span><span class="p">,</span> <span class="s1">&#39;RandomForestClassifier_baseline_wx.csv&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/opt/conda/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py:702: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.
  warnings.warn(
</pre>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;max_depth&#39;: 10, &#39;max_features&#39;: &#39;sqrt&#39;, &#39;n_estimators&#39;: 150}
CPU times: user 14.8 s, sys: 717 ms, total: 15.6 s
Wall time: 38min 45s
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Model fitting</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">rf_wx_params</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span>
<span class="k">except</span><span class="p">:</span>
    <span class="c1"># Hardcoded values based on grid search results</span>
    <span class="n">rf_wx_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rf_wx_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_tree</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">rf_wx_params</span><span class="p">),</span>
    <span class="s1">&#39;baseline_wx&#39;</span><span class="p">,</span> 
    <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="histogram-based-gradient-boosting">
<h3>Histogram-Based Gradient Boosting<a class="headerlink" href="#histogram-based-gradient-boosting" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/ensemble.html#histogram-based-gradient-boosting">documentation</a> for the meaning and approaches to the hyper-parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hbgb_param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hbgb_param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id5">
<h4>Baseline<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Grid search:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">HistGradientBoostingClassifier</span><span class="p">(),</span>
    <span class="n">hbgb_param_grid</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">],</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res_path</span><span class="p">,</span> <span class="s1">&#39;HistGradientBoostingClassifier_baseline.csv&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 5, &#39;max_iter&#39;: 150}
CPU times: user 3min 42s, sys: 3.91 s, total: 3min 46s
Wall time: 6min 1s
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Model fitting</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hbgb_baseline_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_tree</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">HistGradientBoostingClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">),</span>
    <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> 
    <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Grid search:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">HistGradientBoostingClassifier</span><span class="p">(),</span>
    <span class="n">hbgb_param_grid</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">],</span> 
    <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;train_all&#39;</span><span class="p">)[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res_path</span><span class="p">,</span> <span class="s1">&#39;HistGradientBoostingClassifier_baseline_wx.csv&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 5, &#39;max_iter&#39;: 150}
CPU times: user 4min 50s, sys: 4.64 s, total: 4min 55s
Wall time: 9min 28s
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Model fitting</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hbgb_wx_res</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">run_tree</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">.</span><span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">HistGradientBoostingClassifier</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;baseline_wx&#39;</span><span class="p">,</span> 
    <span class="n">res_path</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><strong>NOTE</strong> - As of April 21st’22, standard gradient-boosted trees are deprecated due to their long training time and similar performance with histogram-based ones.</p>
</div>
</div>
<div class="section" id="gradient-tree-boosting">
<h3>Gradient Tree Boosting<a class="headerlink" href="#gradient-tree-boosting" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://scikit-learn.org/stable/modules/ensemble.html#gradient-boosting">documentation</a> for the meaning and approaches to the hyper-parameters (mostly <code class="docutils literal notranslate"><span class="pre">n_estimators</span></code> and <code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>).</p>
<div class="section" id="id7">
<h4>Baseline<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gbt_baseline_res</span> <span class="o">=</span> <span class="n">run_tree</span><span class="p">(</span>
    <span class="n">class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.</span><span class="p">),</span>
    <span class="s1">&#39;baseline&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;model_results/&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id8">
<h4>Baseline + <span class="math notranslate nohighlight">\(WX\)</span><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gbt_baseline_res</span> <span class="o">=</span> <span class="n">run_tree</span><span class="p">(</span>
    <span class="n">class_names</span> <span class="o">+</span> <span class="n">w_class_names</span><span class="p">,</span> 
    <span class="s1">&#39;label&#39;</span><span class="p">,</span> 
    <span class="n">db</span><span class="p">,</span> 
    <span class="n">train_ids</span><span class="p">,</span> 
    <span class="n">val_ids</span><span class="p">,</span> 
    <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.</span><span class="p">),</span>
    <span class="s1">&#39;baseline_wx&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;model_results/&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ai_experiments"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="predict_from_numpy.html" title="previous page">Predict signature types from a numpy array of chips</a>
    <a class='right-next' id="next-link" href="explore_model_performance.html" title="next page">Explore model performances</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani Arribas-Bel, Martin Fleischmann<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>